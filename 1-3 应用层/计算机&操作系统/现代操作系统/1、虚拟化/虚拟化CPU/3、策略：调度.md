# 一、进程调度：介绍

## 1.调度的相关概念

### 工作负载：
任何一种调度都是不可能满足所有条件的，我们需要先去假定一些东西，然后再来进行一个策略的选择与设计。

### 调度指标

比较不同的调度策略。

常见的指标有：性能指标（进程切换周转时间）、公平、响应时间。

## 2.相关的调度策略

### 先进先出（FIFO）

最常见的算法，先到先运行，运行完了就下一个。

缺点：存在护航效应，也就是一些消耗较少的资源消费者排在了重量级消费者后面。

### 最短任务优先（SJF，shortest job first）

有限运行最短时间，但是是非抢占式，所以同样存在护航效应。

### 最短完成时间优先（STCF,shrotest time to completion first）

向SJF添加抢占。

### 轮转（RR,Round-Robin）

轮流使用，响应时间好，但是周转时间过长。

### 结合I/O

此类调度可以用IO的操作较慢，在等待IO的时候进行重叠操作。

## 3.小结

上述相关策略都是在一定假设下完成的，各有缺点和优点，使用不同场景，但是并不是都很通用。并且每一个进程的工作时间通常是未知的，仅此一点，上述调度策略就显得不够用了，需要引进更加通用的调度策略。

# 二、多级反馈队列（MLFQ）

## 1.相关概念

运用于兼容时分共享系统，它解决两个问题，优化周转时间和给交互用户更好的交互体验，使用多级队列，用最近的历史预测未来。

## 2.具体实现

构建多级队列，和UCOS中的内核相似，给进程赋予优先级，同级任务进行轮转，但是优先级由操作系统根据任务状态调整。它应满足一下条件：

+ 如果A优先级>B优先级，运行A
+ 如果A优先级=B优先级，轮转A,B
+ 工作进入系统时，放在最高优先级
+ 一旦工作完成某一层的时间配额（无论主动放弃了多少次CPU），都降一级。（防止恶意利用漏洞，占用CPU）
+ 一段时间S，将系统所有工作重新加入最高级队列 。（防止饿死）

MLFQ有多种实现，版本也有很多，有的可以根据经验配置每一层的时间片长度，队列长度，有的每一级时间片长度递增，并且每一秒左右提升一次进程的优先级，有的采用数学公式来调整优先级。

## 3.小结

可以将这种调度算法看成是时间片轮转调度算法和优先级调度算法的结合，适用于交互式系统（BSD UNIX、Windows NT等等）。

