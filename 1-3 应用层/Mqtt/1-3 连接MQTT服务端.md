## CONNECT – 连接服务端
客户端首先需要发送CONNECT（报文）数据包，进行连接请求，内容如下：

![MQTT CONNECT 报文内容](https://gitee.com/wang_chunfeng/pic-go/raw/master/img/20210223153214.gif)

+ clientId: 一个服务端下的客户端ID必须唯一
+ cleanSession：不同的客户端可以拥有不同的重要等级，重要的客户端需要回复，若每回复确认信息，则会先保存待发送信息，反复发送，得到确认后停止，清除。
	+ 重要客户端需要设置为false（不要干净会话，要保存反复发送，同时服务质量QOS需要大于零）
+ keepAlive:心跳时间间隔，服务端查看客户端连接状态。

## CONNACK – 确认连接请求

服务端收到客户端的CONNECT之后，需要返回一个CONNACK，进行连接确认

![MQTT CONNACK 信息内容](https://gitee.com/wang_chunfeng/pic-go/raw/master/img/20210223155044.gif)

+ sessionPresent:（当前会话），服务端告诉客户端（客户端被设置为重要客户端）是否保存有上次未发送成功的信息。

+ returnCode:连接返回码。

| 返回码 | 返回码描述                                                   |
| :----- | :----------------------------------------------------------- |
| 0      | 成功连接                                                     |
| 1      | 连接被服务端拒绝，原因是不支持客户端的MQTT协议版本           |
| 2      | 连接被服务端拒绝，原因是不支持客户端标识符的编码。 可能造成此原因的是客户端标识符编码是UTF-8，但是服务端不允许使用此编码。 |
| 3      | 连接被服务端拒绝，原因是服务端不可用。 即，网络连接已经建立，但MQTT服务不可用。 |
| 4      | 连接被服务端拒绝，原因是用户名或密码无效。                   |
| 5      | 连接被服务端拒绝，原因是客户端未被授权连接到此服务端。       |