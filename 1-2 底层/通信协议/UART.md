## UART简介
通用异步收发传输器
### 硬件层
+ 高电平为1，低电平为0
+ RX收，TX发
+ 起始位：UART数据传输线通常在不传输数据时保持在高电平。为了开始数据传输，发送端UART在一个时钟周期内将传输线从高电平拉低到低电平。当接收端UART检测到高电压到低电压转换时，它开始以波特率的频率读取数据位中的每一位数据。
+ 数据：数据位包含正在传输的实际数据。如果使用奇偶校验位，则可以是5位，最多8位。如果不使用奇偶校验位，则数据帧的长度可以为9位。在大多数情况下，数据首先以低有效位发送。
+ 校验方法有奇校验(odd)、偶校验(even)、 0 校验(space)、 1 校验(mark)以及无校验(noparity)
	+ 奇校验要求有效数据和校验位中“1”的个数为奇数，偶校验反之
+ 停止位：发送端UART将数据传输线从低电压驱动到高电压至少持续两位数据的时间宽度来表示整个数据包的传输已经结束。
	+ 由于数据是在传输线上定时的，并且每一个设备有其自己的时钟，很可能在通信中两台设备间出现了小小的不同步。因此停止位不仅仅是表示传输的结束，并且提供计算机校正时钟同步的机会。适用于停止位的位数越多，不同时钟同步的容错性越好，但是数据传输率同时也越慢。
### 协议层
+ UART传输的数据被封装成数据包。每个数据包包含1个起始位，5~9个数据位（取决于UART的具体设置），一个可选的奇偶校验位以及1个或2个停止位
+ 由启始位、主体数据、校验位以及停止位组成通讯双方的数据包格式要约定一致才能正常收发数据
+ 常见波特率4800，9600，115200
+ 数据起始由0表示，停止由0.5个或1个或1.5个逻辑1表示
+ 串口协议通常会首先发送最低有效位，因此最小位在最左边`LSB`
### UART的物理层
UART、RS232、RS485在串口通信中，主要区别是电平的不同，其中UART通常使用TTL电平，下面介绍这几个存在的差异；

+ TTL
TTL全名是晶体管-晶体管逻辑集成电路(Transistor-Transistor Logic)
输入高电平最小2V，输出高电平最小2.4V，典型值3.4V；
输入低电平最大0.8V，输出低电平最大0.4V，典型值0.2V。

+ RS232
RS232 逻辑1电平(MARK)=-3V～-15V，逻辑0电平(SPACE)=+3～+15V；

+ RS485
RS485是差分信号进行串行传输；
逻辑1以两线间的电压差为+(2~6)V表示；
逻辑"0"以两线间的电压差为-(2~6)V表示；

+ 在工业通信中，使用RS485比较多，因为RS485是差分信号，可以抑制共模干扰，因此在恶劣的环境中拥有很好的抗干扰性，比较稳定；
### 注意 半主机模式
因为MCU本身资源的限制，在MCU上运行的C语言代码和在计算机上还是有区别的。这就涉及到一种叫半主机的机制，它使得在ARM目标上跑的代码，如果主机电脑运行了调试器，那么该代码可以使用该主机电脑的输入输出设备。 这点非常重要，因为开发初期，可能开发者根本不知道该 ARM 器件上有什么输入输出设备，而半主基机制使得你不用知道ARM器件的外设，利用主机电脑的外设就可以实现输入输出调试。 所以要利用目标 ARM器件的输入输出设备，首先要关掉半主机机制。然后再将输入输出重定向到 ARM 器件上，如 printf 。需要重写 fputc。
printf之类的函数，使用了半主机模式。使用标准库会导致程序无法运行 ,以下是解决方法 :
方法 1.使用微库 ,因为使用微库的话 ,不会使用半主机模式 .
如果使用的是 MDK，请在工程属性的 “Target “- >”Code Generation “中勾选 ”Use MicroLIB “这样以后就可以
使用 printf ，sprintf 函数了
方法 2.仍然使用标准库 ,在主程序添加下面代码 :
/*为确保没有从 C 库链接使用半主机的函数，因为不使用半主机，标准 C 库 stdio.h 中有些使用半主机的
函数要重新写 ,您必须为这些函数提供自己的实现 */
```c
#pragma import(__use_no_semihosting)
void _sys_exit(int x)
{
    x = x;
}
struct __FILE
{
    int handle;
    /* Whatever you require here. If the only file you are using is */
    /* standard output using printf() for debugging, no file handling */
/* is required. */
};
/* FILE is typedef?d in stdio.h. */
FILE __stdout;


```



## STM32中的驱动


## HC32中的驱动